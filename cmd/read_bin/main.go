package main

import (
	"bufio"
	"encoding/json"
	"fmt"
	"os"

	"github.com/sleepinggenius2/gosmi"
	"github.com/sleepinggenius2/gosmi/types"
)

var moduleNames = []string{
	"MPLS-LDP-MIB.mib",
	"SNMP-COMMUNITY-MIB.mib",
	"SNMP-FRAMEWORK-MIB.mib",
	"SNMP-MPD-MIB.mib",
	"SNMP-NOTIFICATION-MIB.mib",
	"SNMP-PROXY-MIB.mib",
	"SNMP-TARGET-MIB.mib",
	"SNMP-USER-BASED-SM-MIB.mib",
	"SNMP-USM-AES-MIB.mib",
	"SNMP-USM-MIB.mib",
	"SNMP-VACM-MIB.mib",
	"SNMP-VIEW-BASED-ACM-MIB.mib",
	"SNMPv2-CONF.mib",
	"SNMPv2-MIB.mib",
	"SNMPv2-SMI.mib",
	"SNMPv2-TC.mib",
	"rfc1065-SMI.mib",
	"rfc1155-SMI.mib",
	"rfc1156-MIB.mib",
	"rfc1158-MIB-II.mib",
	"rfc1162-ConnectionLess-Network-System-CLNS.mib",
	"rfc1213-MIB-II.mib",
	"rfc1215-TRAPS.mib",
	"rfc1224-Asynchronously-Generated-Alerts.mib",
	"rfc1227-SNMP-MUX.mib",
	"rfc1229-Generic-Interface-Table.mib",
	"rfc1230-IEEE-802.mib",
	"rfc1231-IEEE-802.mib",
	"rfc1232-DS1-Interface.mib",
	"rfc1233-DS3-Interface.mib",
	"rfc1238-ConnectionLess-Network-System-CLNS.mib",
	"rfc1243-AppleTalk.mib",
	"rfc1248-OSPF-Version-2.mib",
	"rfc1252-OSPF-Version-2.mib",
	"rfc1253-OSPF-Version-2.mib",
	"rfc1269-Border-Gateway-Protocol-BGP-Version-3.mib",
	"rfc1271-Remote-Network-Monitoring-RMON-TRAP.mib",
	"rfc1271-Remote-Network-Monitoring-RMON.mib",
	"rfc1284-Ethernet-like-Interface.mib",
	"rfc1285-FDDI.mib",
	"rfc1286-Briges.mib",
	"rfc1289-DECnet-Phase-IV.mib",
	"rfc1298-SNMP-over-IPX.mib",
	"rfc1304-SMDS-Interface.mib",
	"rfc1315-Frame-Relay-DTE.mib",
	"rfc1316-Character-Stream-Devices.mib",
	"rfc1317-RS-232-like-Hardware-Devices.mib",
	"rfc1318-Parallel-printer-like-Hardware-Devices.mib",
	"rfc1353-SNMP-Parties.mib",
	"rfc1354-IP-Forwarding-Table.mib",
	"rfc1368-IEEE-802.mib",
	"rfc1381-X.mib",
	"rfc1382-X.mib",
	"rfc1389-RIP-Version-2.mib",
	"rfc1398-Ethernet-like-Interface.mib",
	"rfc1406-DS1-and-E1-Interface.mib",
	"rfc1407-DS3-and-E3-Interface.mib",
	"rfc1414-Identification.mib",
	"rfc1443-SNMPv2-TC.mib",
	"rfc1444-SNMPv2-CONF.mib",
	"rfc1447-SNMPv2-Party.mib",
	"rfc1449-SNMPv2-TM.mib",
	"rfc1450-SNMPv2-MIB.mib",
	"rfc1451-SNMPv2-M2M.mib",
	"rfc1461-Multiprotocol-Interconnect-over-X.mib",
	"rfc1471-PPP-LCP.mib",
	"rfc1472-PPP-Security.mib",
	"rfc1473-PPP-IP.mib",
	"rfc1474-PPP-Bridge-NCP.mib",
	"rfc1493-Bridges.mib",
	"rfc1494-Equivalences-between-1988-X.mib",
	"rfc1495-Mapping-between-X.mib",
	"rfc1512-FDDI-SMT73.mib",
	"rfc1513-RMON-Token-Ring.mib",
	"rfc1514-Host-Resources.mib",
	"rfc1515-IEEE-802.mib",
	"rfc1516-IEEE-802.mib",
	"rfc1525-Source-Routing-Bridges.mib",
	"rfc1559-DECnet-Phase-IV.mib",
	"rfc1565-Network-Services-Monitoring.mib",
	"rfc1566-Mail-Monitoring.mib",
	"rfc1567-X.mib",
	"rfc1573-IF-Interfaces-Group.mib",
	"rfc1573-IF-Interfaces-Group2.mib",
	"rfc1592-Distributed-Protocol-Interface-DPI-Version-2.mib",
	"rfc1593-SNA-APPN-Node.mib",
	"rfc1595-SONET-A6SDH-Interface.mib",
	"rfc1596-Frame-Relay-Service.mib",
	"rfc1604-Frame-Relay-Service.mib",
	"rfc1611-DNS-Server.mib",
	"rfc1612-DNS-Resolver.mib",
	"rfc1628-UPS.mib",
	"rfc1643-Ethernet-like-Interface.mib",
	"rfc1650-Ethernet-like-Interface.mib",
	"rfc1657-Border-Gateway-Protocol-BGP-Version-4.mib",
	"rfc1658-Character-Stream-Devices.mib",
	"rfc1659-RS-232-like-Hardware-Devices.mib",
	"rfc1660-Parallel-printer-like-Hardware-Devices.mib",
	"rfc1665-SNA-NAU.mib",
	"rfc1666-SNA-NAU.mib",
	"rfc1694-SMDS-Interface.mib",
	"rfc1695-ATM-Management.mib",
	"rfc1696-Modem.mib",
	"rfc1697-Relational-Database-Management-System-RDBMS.mib",
	"rfc1724-RIP-Version-2.mib",
	"rfc1742-AppleTalk.mib",
	"rfc1743-IEEE-802.mib",
	"rfc1747-SNA-Data-Link-Control-SDLC.mib",
	"rfc1748-IEEE-802.mib",
	"rfc1749-IEEE-802.mib",
	"rfc1757-Remote-Network-Monitoring-RMON.mib",
	"rfc1759-Printer.mib",
	"rfc1850-OSPF-Version-2.mib",
	"rfc1850-OSPF-Version-22.mib",
	"rfc1903-SNMPv2-TC.mib",
	"rfc1904-SNMPv2-CONF.mib",
	"rfc1906-SNMPv2-TM.mib",
	"rfc1907-SNMPv2-MIB.mib",
	"rfc1910-SNMPv2-USEC.mib",
	"rfc2006-Mobile-IP.mib",
	"rfc2011-IP-ICMP.mib",
	"rfc2012-TCP.mib",
	"rfc2013-UDP.mib",
	"rfc2020-IEEE-802.mib",
	"rfc2021-RMON2.mib",
	"rfc2024-Data-Link-Switches.mib",
	"rfc2037-Entity.mib",
	"rfc2051-APPC.mib",
	"rfc2064-Traffic-Flow-Measurement---Meter.mib",
	"rfc2096-IP-Forward.mib",
	"rfc2108-IEEE-802.mib",
	"rfc2115-Frame-Relay-DTE.mib",
	"rfc2127-ISDN-Interface.mib",
	"rfc2128-Dial-Control.mib",
	"rfc2155-APPN.mib",
	"rfc2206-RSVP.mib",
	"rfc2213-Integrated-Services.mib",
	"rfc2214-Integrated-Services-Guaranteed.mib",
	"rfc2232-APPN-DLUR.mib",
	"rfc2233-IF-Interfaces-Group.mib",
	"rfc2238-HPR.mib",
	"rfc2239-IEEE-802.mib",
	"rfc2248-Network-Services-Monitoring.mib",
	"rfc2249-Mail-Monitoring.mib",
	"rfc2266-IEEE-802.mib",
	"rfc2271-SNMP-Frameworks.mib",
	"rfc2272-SNMP-Message-Processing-and-Dispatching-MPD.mib",
	"rfc2273-SNMP-Applications.mib",
	"rfc2273-SNMP-Applications2.mib",
	"rfc2273-SNMP-Applications3.mib",
	"rfc2274-SNMP-User-based-Security-Model-USM.mib",
	"rfc2275-SNMP-View-based-Access-Control-Model-VACM.mib",
	"rfc2287-System-Applications.mib",
	"rfc2320-Classical-IP-and-ARP-Over-ATM-IPOA.mib",
	"rfc2325-Drip-Type-Heated-Beverage-Hardware-Devices.mib",
	"rfc2358-Ethernet-like-Interface.mib",
	"rfc2366-Multicast-over-UNI-3.mib",
	"rfc2417-Multicast-over-UNI-3.mib",
	"rfc2452-IPV6-TCP.mib",
	"rfc2454-IPV6-UDP.mib",
	"rfc2455-APPN.mib",
	"rfc2456-APPN-TRAPS.mib",
	"rfc2457-Extended-Border-Node.mib",
	"rfc2465-IPv6.mib",
	"rfc2465-IPv62.mib",
	"rfc2466-ICMPv6.mib",
	"rfc2493-15-Minute-Based-Performance-History-TCs.mib",
	"rfc2494-DS0-and-DS0-Bundle-Interface.mib",
	"rfc2494-DS0-and-DS0-Bundle-Interface2.mib",
	"rfc2495-DS1,-E1,-DS2-and-E2-Interface.mib",
	"rfc2512-ATM-Accounting-Information.mib",
	"rfc2513-Controlling-the-Collection-and-Storage-of-Accounting-Information.mib",
	"rfc2514-ATM-TC.mib",
	"rfc2515-ATM-Management.mib",
	"rfc2558-SONET-A6SDH-Interface.mib",
	"rfc2561-TN3270E.mib",
	"rfc2562-TN3270E-Response-Time-Collection.mib",
	"rfc2564-Application.mib",
	"rfc2571-SNMP-Frameworks.mib",
	"rfc2572-SNMP-Message-Processing-and-Dispatching-MPD.mib",
	"rfc2573-SNMP-Applications.mib",
	"rfc2573-SNMP-Applications2.mib",
	"rfc2573-SNMP-Applications3.mib",
	"rfc2574-SNMP-User-based-Security-Model-USM.mib",
	"rfc2575-SNMP-View-based-Access-Control-Model-VACM.mib",
	"rfc2576-Coexistence-between-Version-1,-2-and-3.mib",
	"rfc2578-SNMPv2-SMI.mib",
	"rfc2579-SNMPv2-TC.mib",
	"rfc2580-SNMPv2-CONF.mib",
	"rfc2584-HPR-IP.mib",
	"rfc2591-Scheduling-Management-Operations.mib",
	"rfc2592-Delegation-of-Management-Scripts.mib",
	"rfc2594-WWW.mib",
	"rfc2605-Directory-Server-Monitoring.mib",
	"rfc2613-SMON.mib",
	"rfc2618-RADIUS-Authentication-Client.mib",
	"rfc2619-RADIUS-Authentication-Server.mib",
	"rfc2620-RADIUS-Accounting-Client.mib",
	"rfc2621-RADIUS-Accounting-Server.mib",
	"rfc2662-ADSL-Lines.mib",
	"rfc2662-ADSL-Lines2.mib",
	"rfc2665-Ethernet-like-Interface.mib",
	"rfc2666-Identifying-Ethernet-Chip-Sets.mib",
	"rfc2667-IP-Tunnel.mib",
	"rfc2668-IEEE-802.mib",
	"rfc2669-DOCSIS-Cable-Device.mib",
	"rfc2670-DOCSIS-Radio-Frequency-RF-Interface.mib",
	"rfc2677-NBMA-Next-Hop-Resolution-Protocol-NHRP.mib",
	"rfc2707-Job-Monitoring-MIB---V1.mib",
	"rfc2720-Traffic-Flow-Measurement---Meter.mib",
	"rfc2737-Entity-Version-2.mib",
	"rfc2742-Extensible-SNMP-Agents.mib",
	"rfc2758-Service-Level-Agreements-Performance-Monitoring-SLAPM.mib",
	"rfc2786-Diffie-Helman-USM-Key.mib",
	"rfc2787-Virtual-Router-Redundancy-Protocol-VRRP.mib",
	"rfc2788-Network-Services-Monitoring.mib",
	"rfc2789-Mail-Monitoring.mib",
	"rfc2790-Host-Resources.mib",
	"rfc2790-Host-Resources2.mib",
	"rfc2819-Remote-Network-Monitoring-RMON.mib",
	"rfc2837-Fabric-Element-in-Fibre-Channel-Standard.mib",
	"rfc2851-Textual-Conventions-for-Internet-Network-Addresses.mib",
	"rfc2856-High-Capacity-Data-Types.mib",
	"rfc2863-IF-Interfaces-Group.mib",
	"rfc2864-IF-Interfaces-Inverted-Stack-Extension.mib",
	"rfc2922-Physical-Topology.mib",
	"rfc2925-Ping,-Traceroute,-and-Lookup.mib",
	"rfc2925-Ping,-Traceroute,-and-Lookup2.mib",
	"rfc2925-Ping,-Traceroute,-and-Lookup3.mib",
	"rfc2932-IPv4-Multicast-Routing.mib",
	"rfc2933-Internet-Group-Management-Protocol-IGMP.mib",
	"rfc2934-Protocol-Independent-Multicast-PIM-for-IPv4.mib",
	"rfc2940-Open-Policy-Service-COPS-Protocol-Clients.mib",
	"rfc2954-Frame-Relay-Service.mib",
	"rfc2955-FR-to-ATM-Service-Interworking.mib",
	"rfc2959-Real-Time-Transport-Protocol-RTP.mib",
	"rfc2981-Event.mib",
	"rfc2982-Distributed-Management-Expression.mib",
	"rfc3014-Notification-Log.mib",
	"rfc3019-IPv6---Multicast-Listener-Discovery-MLD-Protocol.mib",
	"rfc3020-Monitoring-and-Controlling-the-UNI-A6NNI-Multilink-Frame-Relay-Function.mib",
	"rfc3055-PINT-Services.mib",
	"rfc3083-DOCSIS-Baseline-Privacy.mib",
	"rfc3144-RMON-Extensions-for-Interface-Parameters-Monitoring.mib",
	"rfc3165-Delegation-of-Management-Scripts.mib",
	"rfc3176-InMon-Corporation-s-sFlow.mib",
	"rfc3201-Circuit-to-Interface-Translation.mib",
	"rfc3202-Frame-Relay-Service-Level-Definitions.mib",
	"rfc3231-Scheduling-Management-Operations.mib",
	"rfc3273-RMON-for-High-Capacity-Networks-HC-RMON.mib",
	"rfc3287-RMON-for-Differentiated-Services-DSMON.mib",
	"rfc3289-Differentiated-Services-Architecture.mib",
	"rfc3289-Differentiated-Services-Architecture2.mib",
	"rfc3291-Textual-Conventions-for-Internet-Network-Addresses.mib",
	"rfc3295-General-Switch-Management-Protocol-GSMP.mib",
	"rfc3371-Layer-Two-Tunneling-Protocol-L2TP.mib",
	"rfc3411-SNMP-Frameworks.mib",
	"rfc3412-SNMP-Message-Processing-and-Dispatching-MPD.mib",
	"rfc3413-SNMP-Applications.mib",
	"rfc3413-SNMP-Applications2.mib",
	"rfc3413-SNMP-Applications3.mib",
	"rfc3414-SNMP-User-based-Security-Model-USM.mib",
	"rfc3415-SNMP-View-based-Access-Control-Model-VACM.mib",
	"rfc3417-SNMPv2-TM.mib",
	"rfc3418-SNMPv2-MIB.mib",
	"rfc3419-TC-for-Transport-Addresses.mib",
	"rfc3433-Entity-Sensor.mib",
	"rfc3434-RMON-Extensions-for-High-Capacity-Alarms.mib",
	"rfc3440-ADSL-Line-Extension.mib",
	"rfc3498-SONET-Linear-Automatic-Protection-Switching-APS.mib",
	"rfc3512-Configuring-Networks-and-Devices-with-SNMP.mib",
	"rfc3559-Multicast-Address-Allocation.mib",
	"rfc3584-Coexistence-between-Version-1,-2-and-3.mib",
	"rfc3591-Optical-Interface-Type.mib",
	"rfc3592-SONET-A6SDH-Interface.mib",
	"rfc3593-15-Minute-Based-Performance-History-TCs.mib",
	"rfc3595-Textual-Conventions-for-IPv6-Flow-Label.mib",
	"rfc3606-Supplemental-ATM-Managed-Objects.mib",
	"rfc3621-Power-Ethernet.mib",
	"rfc3635-Ethernet-like-Interface.mib",
	"rfc3636-IEEE-802.mib",
	"rfc3637-Ethernet-WIS-Objects.mib",
	"rfc3705-High-Capacity-Perfhist-TC.mib",
	"rfc3728-Very-High-Speed-Digital-Subscriber-Lines-VDSL.mib",
	"rfc3729-Application-Performance-Measurement-APM.mib",
	"rfc3747-Differentiated-Services-Configuration.mib",
	"rfc3805-Printer-MIB-v2.mib",
	"rfc3805-Printer-MIB-v22.mib",
	"rfc3806-Printer-Finishing.mib",
	"rfc3806-Printer-Finishing2.mib",
	"rfc3808-IANA-Charset.mib",
	"rfc3811-MPLS-Textual-Conventions.mib",
	"rfc3812-MPLS-Traffic-Engineering-TE.mib",
	"rfc3813-MPLS-Label-Switching-Router-LSR.mib",
	"rfc3814-MPLS-Forwarding-Equivalence-Class-To-Next-Hop-Label-Forwarding-Entry-FEC-To-NHLFE.mib",
	"rfc3815-MPLS-Label-Distribution-Protocol-LDP.mib",
	"rfc3815-MPLS-Label-Distribution-Protocol-LDP2.mib",
	"rfc3815-MPLS-Label-Distribution-Protocol-LDP3.mib",
	"rfc3815-MPLS-Label-Distribution-Protocol-LDP4.mib",
	"rfc3816-RObust-Header-Compression-ROHC.mib",
	"rfc3816-RObust-Header-Compression-ROHC2.mib",
	"rfc3816-RObust-Header-Compression-ROHC3.mib",
	"rfc3826-Advanced-Encryption-Standard-AES-for-SNMP-s-USM.mib",
	"rfc3872-Telephony-Routing-over-IP-TRIP.mib",
	"rfc3872-Telephony-Routing-over-IP-TRIP2.mib",
	"rfc3873-Stream-Control-Transmission-Protocol-SCTP.mib",
	"rfc3877-Alarm.mib",
	"rfc3877-Alarm2.mib",
	"rfc3877-Alarm3.mib",
	"rfc3877-Alarm4.mib",
	"rfc3878-Alarm-Reporting-Control.mib",
	"rfc3895-DS1,-E1,-DS2,-and-E2-Interface-Types.mib",
	"rfc3896-DS3__E3-Interface-Type.mib",
	"rfc3970-Traffic-Engineering-TE.mib",
	"rfc4001-Textual-Conventions-for-Internet-Network-Addresses.mib",
	"rfc4008-Network-Address-Translators-NAT.mib",
	"rfc4011-Policy-Based-Management.mib",
	"rfc4022-Transmission-Control-Protocol-TCP.mib",
	"rfc4036-DOCSIS-Cable-Modem-Termination-Systems.mib",
	"rfc4044-Fibre-Channel-Management.mib",
	"rfc4069-VDSL-Using-SCM-Line-Coding.mib",
	"rfc4070-VDSL-Using-MCM-Line-Coding.mib",
	"rfc4087-IP-Tunnel.mib",
	"rfc4113-User-Datagram-Protocol-UDP.mib",
	"rfc4131-DOCSIS-BPI-Plus.mib",
	"rfc4133-Entity-MIB-Version-3.mib",
	"rfc4148-IP-Performance-Metrics-IPPM-Metrics-Registry.mib",
	"rfc4149-Synthetic-Sources-for-Performance-Monitoring-SSPM-Algorithms.mib",
	"rfc4150-Transport-Performance-Metrics.mib",
	"rfc4188-Bridges.mib",
	"rfc4220-MPLS-TE-Link.mib",
	"rfc4265-VPN-TC.mib",
	"rfc4268-Entity-State.mib",
	"rfc4268-Entity-State2.mib",
	"rfc4273-Border-Gateway-Protocol-Version-4-BGP4-or-lower.mib",
	"rfc4292-IP-Forwarding-Table.mib",
	"rfc4293-Internet-Protocol-IP.mib",
	"rfc4295-Mobile-IPv6.mib",
	"rfc4318-Rapid-Spanning-Tree-Protocol-RSTP.mib",
	"rfc4323-IPCDN-DOCSIS-QoS.mib",
	"rfc4327-Link-Management-Protocol-LMP.mib",
	"rfc4363-Bridge-MIB-Extensions.mib",
	"rfc4363-Bridge-MIB-Extensions2.mib",
	"rfc4368-MPLS-LC-ATM-and-FR-MIBs.mib",
	"rfc4368-MPLS-LC-ATM-and-FR-MIBs2.mib",
	"rfc4369-Internet-Fibre-Channel-Protocol-iFCP.mib",
	"rfc4382-MPLS__BGP-Layer-3-Virtual-Private-Network-VPN.mib",
	"rfc4404-Fibre-Channel-Over-TCP__IP-FCIP.mib",
	"rfc4438-Fibre-Channel-Name-Server.mib",
	"rfc4439-Fibre-Channel-Fabric-Address-Manager.mib",
	"rfc4439-Fibre-Channel-Fabric-Address-Manager2.mib",
	"rfc4444-Intermediate-System-to-Intermediate-System-IS-IS.mib",
	"rfc4455-Small-Computer-System-Interface-SCSI-Entities.mib",
	"rfc4498-Managed-Object-Aggregation.mib",
	"rfc4498-Managed-Object-Aggregation2.mib",
	"rfc4502-RMON2.mib",
	"rfc4544-iSCSI.mib",
	"rfc4545-IPS-Authorization.mib",
	"rfc4546-DOCSIS-2.mib",
	"rfc4547-DOCSIS-Event-Notification.mib",
	"rfc4560-Ping,-Traceroute,-and-Lookup.mib",
	"rfc4560-Ping,-Traceroute,-and-Lookup2.mib",
	"rfc4560-Ping,-Traceroute,-and-Lookup3.mib",
	"rfc4624-Multicast-Source-Discovery-Protocol-MSDP.mib",
	"rfc4625-Fibre-Channel-Routing-Information.mib",
	"rfc4626-Fibre-Channel-s-Fabric-Shortest-Path-First-FSPF-Protocol.mib",
	"rfc4631-Link-Management-Protocol-LMP.mib",
	"rfc4639-DOCSIS-Cable-Device.mib",
	"rfc4668-RADIUS-Authentication-Client-MIB-for-IPv6.mib",
	"rfc4669-RADIUS-Authentication-Server-MIB-for-IPv6.mib",
	"rfc4670-RADIUS-Accounting-Client-MIB-for-IPv6.mib",
	"rfc4671-RADIUS-Accounting-Server-MIB-for-IPv6.mib",
	"rfc4672-RADIUS-Dynamic-Authorization-Client-MIB.mib",
	"rfc4673-RADIUS-Dynamic-Authorization-Server-MIB.mib",
	"rfc4682-IPCDN-MTA.mib",
	"rfc4706-ADSL2.mib",
	"rfc4706-ADSL22.mib",
	"rfc4711-Real-time-Application-Quality-of-Service-Monitoring-RAQMON.mib",
	"rfc4712-Transport-Mappings-for-RAQMON-PDU.mib",
	"rfc4747-Virtual-Fabrics.mib",
	"rfc4750-OSPF-Version-2.mib",
	"rfc4750-OSPF-Version-22.mib",
	"rfc4780-Session-Initiation-Protocol-SIP.mib",
	"rfc4780-Session-Initiation-Protocol-SIP2.mib",
	"rfc4780-Session-Initiation-Protocol-SIP3.mib",
	"rfc4780-Session-Initiation-Protocol-SIP4.mib",
	"rfc4789-SNMP-over-IEEE-802.mib",
	"rfc4801-TCs-for-GMPLS-Management.mib",
	"rfc4802-GMPLS-TE.mib",
	"rfc4802-GMPLS-TE2.mib",
	"rfc4803-GMPLS-LSR.mib",
	"rfc4803-GMPLS-LSR2.mib",
	"rfc4805-DS1,-J1,-E1,-DS2,-and-E2-Interface-Types.mib",
	"rfc4807-IPsec-SPD-configuration.mib",
	"rfc4836-IEEE-802.mib",
	"rfc4836-IEEE-8022.mib",
	"rfc4837-Ethernet-Passive-Optical-Networks-EPON.mib",
	"rfc4878-OAM-Functions-on-Ethernet-Like-Interfaces.mib",
	"rfc4898-TCP-Extended-Statistics.mib",
	"rfc4935-Fibre-Channel-Fabric-Configuration-Server.mib",
	"rfc4936-Fibre-Channel-Zone-Server.mib",
	"rfc4936-Fibre-Channel-Zone-Server2.mib",
	"rfc4939-iSNS-Internet-Storage-Name-Service.mib",
	"rfc4983-Fibre-Channel-Registered-State-Change-Notification-RSCN.mib",
	"rfc5017-URI-TC.mib",
	"rfc5060-Protocol-Independent-Multicast-PIM.mib",
	"rfc5066-EFMCu-Interfaces.mib",
	"rfc5066-EFMCu-Interfaces2.mib",
	"rfc5097-UDP-Lite-Protocol.mib",
	"rfc5098-PacketCable__IPCablecom-NCS-Signaling.mib",
	"rfc5131-Textual-Convention-for-Language-Tags-LANGTAG-TC-.mib",
	"rfc5132-IP-Multicast-IP-MCAST.mib",
	"rfc5190-Middlebox-Communication-MIDCOM.mib",
	"rfc5240-Protocol-Independent-Multicast-PIM-Bootstrap-Router.mib",
	"rfc5324-Fibre-Channel-Security-Protocols-FC-SP.mib",
	"rfc5324-Fibre-Channel-Security-Protocols-FC-SP2.mib",
	"rfc5324-Fibre-Channel-Security-Protocols-FC-SP3.mib",
	"rfc5324-Fibre-Channel-Security-Protocols-FC-SP4.mib",
	"rfc5324-Fibre-Channel-Security-Protocols-FC-SP5.mib",
}

func main() {

	gosmi.Init()
	defer gosmi.Exit()

	for _, name := range moduleNames {
		//fmt.Printf("load moduel from bin: %s\n", name)
		data, err := Asset(name)
		if err == nil {
			_, err := gosmi.LoadModuleFromStream(name, data)
			if err != nil {
				fmt.Printf("Init Error: %s\n", err)
				return
			}
			//fmt.Printf("Loaded module %s\n", m)
		} else {
			fmt.Println("Fail to load from bin, ", err)
			return
		}
	}

	// test against some OIDs
	// read test file
	oidFile, err := os.Open("test_oid.txt")
	if err != nil {
		fmt.Println("Fail to load test file")
	}
	scanner := bufio.NewScanner(oidFile)
	scanner.Split(bufio.ScanLines)
	var txtLines []string
	for scanner.Scan() {
		txtLines = append(txtLines, scanner.Text())
	}

	oidFile.Close()

	for _, line := range txtLines {
		tOid := types.OidMustFromString(line)
		fmt.Println("OID:", tOid)

		if node, err := gosmi.GetNodeByOID(tOid); err != nil {
			fmt.Printf("Subtree Error: %s\n", err)
		} else {
			subtree := node.GetSubtree()

			jsonBytes, _ := json.Marshal(subtree)
			//os.Stdout.Write(jsonBytes)
			fmt.Println(string(jsonBytes))
		}
	}
}
